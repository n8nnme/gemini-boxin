[DEFAULT]
# Default ban time (24 hours for stealth)
bantime = 86400

# Find time window (10 minutes)
findtime = 600

# Max retry attempts before banning
maxretry = 3

# Ignore local IPs
ignoreip = 127.0.0.1/8 ::1 10.0.0.0/8 192.168.0.0/16 172.16.0.0/12

# Default action (use iptables with specific chain)
action = iptables-multiport[name=%(__name__)s, port="%(port)s", protocol="%(protocol)s", chain="INPUT"]

[sing-box-auth-fail]
# Protection against authentication failures
enabled = true
port = 31847,8443
protocol = tcp,udp
logpath = /var/log/sing-box-auth.log
filter = sing-box-auth
maxretry = 3
findtime = 300
bantime = 86400
action = iptables-multiport[name=sing-box-auth, port="31847,8443", protocol="all"]

[sing-box-port-scan]
# Protection against port scanning
enabled = true
port = all
protocol = tcp
logpath = /var/log/sing-box-scan.log
filter = sing-box-scan
maxretry = 5
findtime = 120
bantime = 172800
action = iptables-allports[name=sing-box-scan]

[sing-box-connection-flood]
# Protection against connection flooding
enabled = true
port = 31847,8443
protocol = tcp,udp
logpath = /var/log/sing-box-flood.log
filter = sing-box-flood
maxretry = 10
findtime = 60
bantime = 43200
action = iptables-multiport[name=sing-box-flood, port="31847,8443", protocol="all"]

[sing-box-brute-force]
# Protection against brute force attacks
enabled = true
port = 31847,8443
protocol = tcp,udp
logpath = /var/log/sing-box-brute.log
filter = sing-box-brute
maxretry = 2
findtime = 600
bantime = 259200
action = iptables-multiport[name=sing-box-brute, port="31847,8443", protocol="all"]

[sing-box-reconnaissance]
# Protection against reconnaissance attempts
enabled = true
port = all
protocol = tcp
logpath = /var/log/sing-box-recon.log
filter = sing-box-recon
maxretry = 1
findtime = 3600
bantime = 604800
action = iptables-allports[name=sing-box-recon]
